{
  "SchemaVersion": 2,
  "CreatedAt": "2025-11-14T20:18:48.0839331-08:00",
  "ArtifactName": "polylab",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": "ec2-creation.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2-creation.yaml:90-117",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 90,
            "EndLine": 117,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "  PolystudentEC2:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentEC2\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "    Type: AWS::EC2::Instance",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Instance",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "      InstanceType: !Ref InstanceType",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref InstanceType",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "      ImageId: !Ref AmiId",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref AmiId",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      KeyName: !Ref KeyPairName",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref KeyPairName",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "      NetworkInterfaces:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mNetworkInterfaces\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "        - DeviceIndex: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mDeviceIndex\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 99,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PolystudentSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 52,
            "EndLine": 52,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "  PolystudentSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "          CidrIp: 0.0.0.0/0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 84,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "          Value: \"polystudent\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: \u001b[38;5;37m\"polystudent\"\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PolystudentSecurityGroup",
                "Filename": "ec2-creation.yaml",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 85
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PolystudentSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 64,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "  PolystudentSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "          CidrIp: 0.0.0.0/0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 84,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "          Value: \"polystudent\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: \u001b[38;5;37m\"polystudent\"\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PolystudentSecurityGroup",
                "Filename": "ec2-creation.yaml",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 85
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PolystudentEC2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 107,
            "EndLine": 111,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "  PolystudentEC2:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentEC2\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "        - DeviceName: \"/dev/sda1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mDeviceName\u001b[0m: \u001b[38;5;37m\"/dev/sda1\"",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "          Ebs:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mEbs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "            VolumeSize: !Ref VolumeSize",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mVolumeSize\u001b[0m: !Ref VolumeSize",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "            VolumeType: gp3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mVolumeType\u001b[0m: gp3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 111,
                  "Content": "            DeleteOnTermination: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mDeleteOnTermination\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 116,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "          Value: \"polystudent\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: \u001b[38;5;37m\"polystudent\"\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PolystudentEC2",
                "Filename": "ec2-creation.yaml",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 117
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "s3-creation.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 47,
        "Failures": 0
      }
    },
    {
      "Target": "vpc-creation.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 5
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 244,
            "EndLine": 244,
            "Code": {
              "Lines": [
                {
                  "Number": 234,
                  "Content": "  SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 235,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 244,
                  "Content": "          CidrIp: 0.0.0.0/0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 276,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "          Value: !Ref EnvironmentName",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Ref EnvironmentName",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "SecurityGroup",
                "Filename": "vpc-creation.yaml",
                "Location": {
                  "StartLine": 234,
                  "EndLine": 277
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 256,
            "EndLine": 256,
            "Code": {
              "Lines": [
                {
                  "Number": 234,
                  "Content": "  SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 235,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "          CidrIp: 0.0.0.0/0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 276,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "          Value: !Ref EnvironmentName",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Ref EnvironmentName",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "SecurityGroup",
                "Filename": "vpc-creation.yaml",
                "Location": {
                  "StartLine": 234,
                  "EndLine": 277
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnetAZ1",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 73,
            "EndLine": 73,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "  PublicSubnetAZ1:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnetAZ1\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "          Value: !Ref EnvironmentName",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Ref EnvironmentName",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnetAZ1",
                "Filename": "vpc-creation.yaml",
                "Location": {
                  "StartLine": 67,
                  "EndLine": 78
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnetAZ2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 86,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "  PublicSubnetAZ2:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnetAZ2\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "          Value: !Ref EnvironmentName",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Ref EnvironmentName",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnetAZ2",
                "Filename": "vpc-creation.yaml",
                "Location": {
                  "StartLine": 80,
                  "EndLine": 91
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "vpc-creation.yaml:34-44",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 34,
            "EndLine": 44,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "  VPC:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mVPC\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "    Type: AWS::EC2::VPC",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::VPC",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "      CidrBlock: !Ref VpcCIDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: !Ref VpcCIDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "      EnableDnsSupport: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mEnableDnsSupport\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "      EnableDnsHostnames: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mEnableDnsHostnames\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "      Tags:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "        - Key: Name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "          Value: !Sub \"${EnvironmentName}-vpc1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Sub \"${EnvironmentName}-vpc1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    }
  ]
}
